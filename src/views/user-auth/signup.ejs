<!DOCTYPE html>
<html>
  <%- include('./partials/head.ejs') %>
  <link href="cssUser/main.css" rel="stylesheet" type="text/css" />

  <body>
    <div
      class="wrapper"
      style="background-image: url('assets/images/redbullPurpleEdition-1.png')"
    >
      <div class="inner">
        <form action="/signup" method="post" onsubmit="return validateForm()">
          <h3>SIGN UP</h3>
          <div class="form-group">
            <div class="form-wrapper">
              <label for="fullname">First Name</label>
              <input
                type="text"
                id="fullname"
                name="fullname"
                class="form-control"
                required
                oninput="validate_input('fullname')"
              />
              <span id="fullname_alert"></span>
            </div>
            <div class="form-wrapper">
              <label for="lastname">Last Name</label>
              <input
                type="text"
                id="lastname"
                name="lastname"
                class="form-control"
                required
                oninput="validate_input('lastname')"
              />
              <span id="lastname_alert"></span>
            </div>
          </div>
          <div class="form-wrapper">
            <label for="email">Email</label>
            <input
              type="text"
              id="email"
              name="email"
              class="form-control"
              required
              oninput="validate_input('email')"
            />
            <span id="email_alert" class="text-danger"> <%= errors %></span>
          </div>
          <div class="form-wrapper">
            <label for="pass">Password</label>
            <input
              type="password"
              id="pass"
              name="password"
              class="form-control"
              required
              oninput="validate_password()"
            />
          </div>
          <div class="form-wrapper">
            <label for="confirm_pass">Confirm Password</label>
            <input
              class="form-control"
              id="confirm_pass"
              type="password"
              name="confirm_pass"
              placeholder="Confirm Password"
              required
              oninput="validate_password()"
            />
          </div>
          <span id="wrong_pass_alert"></span>
          <div class="buttons">
            <button id="create" class="submit_btn w-100">Submit</button>
          </div>
          <br />
          <h5>Already have an account?<a href="/signin">SIGN IN</a></h5>
          <br />
          <br />
        </form>
      </div>
    </div>

    <script>
      reload();

      const errMsg = document.getElementById("email_alert");

      function reload() {
        setTimeout(() => {
          errMsg.innerHTML = "";
        }, 4000);
      }

      function validate_input(field) {
        let input = document.getElementById(field).value.trim();
        let isValid =
          input.length > 0 && (field === "email" || !/\d/.test(input)); // Check if input is not empty and doesn't contain digits unless it's the email field
        if (!isValid) {
          document.getElementById(field + "_alert").style.color = "red";
          if (/\d/.test(input) && field !== "email") {
            document.getElementById(field + "_alert").innerHTML =
              "Numbers are not allowed";
          } else {
            document.getElementById(field + "_alert").innerHTML =
              "Please fill this field";
          }
        } else {
          document.getElementById(field + "_alert").innerHTML = "";
        }
      }

      function validate_password() {
        let pass = document.getElementById("pass").value;
        let confirm_pass = document.getElementById("confirm_pass").value;
        if (pass != confirm_pass) {
          document.getElementById("wrong_pass_alert").style.color = "red";
          document.getElementById("wrong_pass_alert").innerHTML =
            "â˜’ Use same password";
          document.getElementById("create").disabled = true;
          document.getElementById("create").style.opacity = 0.4;
        } else {
          document.getElementById("wrong_pass_alert").style.color = "green";
          document.getElementById("wrong_pass_alert").innerHTML =
            "ðŸ—¹ Password Matched";
          document.getElementById("create").disabled = false;
          document.getElementById("create").style.opacity = 1;
        }
      }

      function validateForm() {
        let isValid = true;
        ["fullname", "lastname", "email"].forEach(function (field) {
          let input = document.getElementById(field).value.trim();
          if (input.length === 0 || (field !== "email" && /\d/.test(input))) {
            document.getElementById(field + "_alert").style.color = "red";
            if (/\d/.test(input) && field !== "email") {
              document.getElementById(field + "_alert").innerHTML =
                "Numbers are not allowed";
            } else {
              document.getElementById(field + "_alert").innerHTML =
                "Please fill this field";
            }
            isValid = false;
          }
        });

        if (!isValid) {
          return false;
        }

        let pass = document.getElementById("pass").value;
        let confirm_pass = document.getElementById("confirm_pass").value;
        if (pass != confirm_pass) {
          document.getElementById("wrong_pass_alert").style.color = "red";
          document.getElementById("wrong_pass_alert").innerHTML =
            "â˜’ Use same password";
          document.getElementById("create").disabled = true;
          document.getElementById("create").style.opacity = 0.4;
          return false;
        }

        return true;
      }
    </script>
  </body>
</html>
